<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Flag Recognition Quiz</title>
    <meta name="description" content="A clean, fast, installable Flag Recognition Quiz PWA built with Vanilla JS and PicoCSS." />
    <meta name="color-scheme" content="light dark" />
    <!-- Theme color (updated by JS for manual preference); media variants for system default -->
    <meta id="meta-theme-color" name="theme-color" content="#457B9D" />
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#457B9D" />
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0b1324" />

    <!-- Apply saved theme early to avoid FOUC -->
    <script>
      (function () {
        try {
          var saved = localStorage.getItem('flags:theme');
          if (saved === 'light' || saved === 'dark') {
            document.documentElement.setAttribute('data-theme', saved);
          } else {
            // No explicit choice; leave unset to follow system
          }
        } catch (e) {}
      })();
    </script>

    <!-- PicoCSS via CDN -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"
    />

    <!-- App styles -->
    <link rel="stylesheet" href="./style.css" />

    <!-- Manifest -->
    <link rel="manifest" href="./manifest.json" />

    <!-- Icons -->
    <link rel="icon" href="./assets/icons/icon-192.svg" type="image/svg+xml" />
  </head>
  <body>
    <header class="container header">
      <nav>
        <ul>
          <li><strong>Flag Quiz</strong></li>
          <li class="mode-select-wrap">
            <label for="modeSelect" class="sr-only">Game mode</label>
            <select id="modeSelect" aria-label="Select game mode" title="Select game mode">
              <option value="quiz">Quiz</option>
              <option value="pairs">Pairs</option>
            </select>
          </li>
        </ul>
        <ul class="header-progress">
          <li>
            <progress id="progressBar" value="0" max="10" aria-label="Quiz progress"></progress>
            <small id="progressCounter" aria-hidden="true">1 / 10 â€¢ 9 left</small>
            <small id="timer" class="timer" aria-live="off" aria-label="Time remaining 03:00">03:00</small>
            <small id="progress" class="sr-only">Question 1 of 10</small>
          </li>
          <li>
            <button id="themeToggle" class="theme-toggle" type="button" aria-label="Toggle dark mode" title="Toggle dark mode">ðŸŒ™</button>
          </li>
        </ul>
      </nav>
    </header>

    <main class="container">
  <article id="quiz-card" class="card">
        <figure id="flag-box" class="flag-box">
          <div id="flagSpinner" class="spinner hidden" role="status" aria-live="polite" aria-label="Loading flag">
            <span class="sr-only">Loading flagâ€¦</span>
          </div>
          <img id="flagImage" alt="Guess the country by its flag" loading="eager" />
        </figure>

        <div id="answers" class="answers">
          <button type="button" class="answer" data-index="0" aria-label="Option 1"></button>
          <button type="button" class="answer" data-index="1" aria-label="Option 2"></button>
          <button type="button" class="answer" data-index="2" aria-label="Option 3"></button>
          <button type="button" class="answer" data-index="3" aria-label="Option 4"></button>
        </div>

        <footer class="actions">
          <button id="nextBtn" class="secondary hidden" disabled>Next question</button>
        </footer>
      </article>

      <!-- Pairs mode -->
      <article id="pairs-card" class="card hidden" aria-labelledby="pairs-title">
        <header>
          <h2 id="pairs-title">Match the pairs</h2>
          <p class="muted" id="pairs-subtitle">Tap a country and then its flag. Match all 5 to go to the next set.</p>
        </header>

        <section class="pairs-grid" aria-live="polite">
          <div class="pairs-col">
            <h3 class="sr-only">Countries</h3>
            <div id="pairs-names" class="pairs-names" role="list"></div>
          </div>
          <div class="pairs-col">
            <h3 class="sr-only">Flags</h3>
            <div id="pairs-flags" class="pairs-flags" role="list"></div>
          </div>
        </section>

        <footer class="actions">
          <button id="pairsNextBtn" class="secondary hidden" type="button">Next 5</button>
        </footer>
      </article>

      <article id="results-card" class="card hidden">
        <header>
          <h2 id="result-title">Results</h2>
          <p id="result-score" class="lead"></p>
          <p id="best-score" class="muted"></p>
        </header>
        <footer class="actions">
          <button id="playAgainBtn" class="contrast">Play again</button>
        </footer>
      </article>
    </main>
    <script src="./script.js" defer></script>
  </body>
  </html>
