<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Flag Recognition Quiz</title>
    <meta name="description" content="A clean, fast, installable Flag Recognition Quiz PWA built with Vanilla JS and PicoCSS." />
    <meta name="color-scheme" content="light dark" />
    <!-- Theme color (updated by JS for manual preference); media variants for system default -->
    <meta id="meta-theme-color" name="theme-color" content="#457B9D" />
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#457B9D" />
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0b1324" />

    <!-- Apply saved theme early to avoid FOUC -->
    <script>
      (function () {
        try {
          var saved = localStorage.getItem('flags:theme');
          if (saved === 'light' || saved === 'dark') {
            document.documentElement.setAttribute('data-theme', saved);
          } else {
            // No explicit choice; leave unset to follow system
          }
        } catch (e) {}
      })();
    </script>

    <!-- PicoCSS via CDN -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"
    />

    <!-- App styles -->
    <link rel="stylesheet" href="./style.css" />

    <!-- Manifest -->
    <link rel="manifest" href="./manifest.json" />

    <!-- Icons -->
    <link rel="icon" href="./assets/icons/icon-192.svg" type="image/svg+xml" />
  </head>
  <body>
    <header class="container header">
      <nav>
        <ul>
          <li><strong>Flag Quiz</strong></li>
        </ul>
        <ul class="header-progress">
          <li>
            <progress id="progressBar" value="0" max="10" aria-label="Quiz progress"></progress>
            <small id="progressCounter" aria-hidden="true">1 / 10 â€¢ 9 left</small>
            <small id="timer" class="timer" aria-live="off" aria-label="Time remaining 03:00">03:00</small>
            <small id="progress" class="sr-only">Question 1 of 10</small>
          </li>
          <li>
            <button id="settingsBtn" class="icon-btn" type="button" aria-label="Open settings" title="Settings">
              <svg class="icon" width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M19.4 13.5a7.9 7.9 0 0 0 0-3l2-1.6a.9.9 0 0 0 .2-1.2l-1.9-3.3a.9.9 0 0 0-1.1-.4l-2.3.9a8 8 0 0 0-2.6-1.5l-.3-2.4A.9.9 0 0 0 12.6 0h-3.3a.9.9 0 0 0-.9.8l-.3 2.4a8 8 0 0 0-2.6 1.5l-2.3-.9a.9.9 0 0 0-1.1.4L.3 7.5a.9.9 0 0 0 .2 1.2l2 1.6a7.9 7.9 0 0 0 0 3l-2 1.6a.9.9 0 0 0-.2 1.2l1.9 3.3c.23.4.73.56 1.14.4l2.26-.9c.74.62 1.62 1.12 2.56 1.46l.34 2.42c.07.46.46.8.93.8h3.3c.47 0 .86-.34.93-.8l.34-2.42c.94-.34 1.82-.84 2.56-1.46l2.26.9c.41.16.91 0 1.14-.4l1.9-3.3a.9.9 0 0 0-.2-1.2l-2-1.6Z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </li>
          <li>
            <button id="themeToggle" class="theme-toggle" type="button" aria-label="Toggle dark mode" title="Toggle dark mode">ðŸŒ™</button>
          </li>
        </ul>
      </nav>
    </header>

    <main class="container">
  <article id="quiz-card" class="card">
        <figure id="flag-box" class="flag-box">
          <div id="flagSpinner" class="spinner hidden" role="status" aria-live="polite" aria-label="Loading flag">
            <span class="sr-only">Loading flagâ€¦</span>
          </div>
          <img id="flagImage" alt="Guess the country by its flag" loading="eager" />
        </figure>

        <div id="answers" class="answers">
          <button type="button" class="answer" data-index="0" aria-label="Option 1"></button>
          <button type="button" class="answer" data-index="1" aria-label="Option 2"></button>
          <button type="button" class="answer" data-index="2" aria-label="Option 3"></button>
          <button type="button" class="answer" data-index="3" aria-label="Option 4"></button>
        </div>

        <footer class="actions">
          <button id="nextBtn" class="secondary hidden" disabled>Next question</button>
        </footer>
      </article>

      <!-- Pairs mode -->
      <article id="pairs-card" class="card hidden" aria-labelledby="pairs-title">
        <header>
          <h2 id="pairs-title">Match the pairs</h2>
          <p class="muted" id="pairs-subtitle">Tap a country and then its flag. Match all 5 to go to the next set.</p>
        </header>

        <section class="pairs-grid" aria-live="polite">
          <div class="pairs-col">
            <h3 class="sr-only">Countries</h3>
            <div id="pairs-names" class="pairs-names" role="list"></div>
          </div>
          <div class="pairs-col">
            <h3 class="sr-only">Flags</h3>
            <div id="pairs-flags" class="pairs-flags" role="list"></div>
          </div>
        </section>

        <footer class="actions">
          <button id="pairsNextBtn" class="secondary hidden" type="button">Next 5</button>
        </footer>
      </article>

      <article id="results-card" class="card hidden">
        <header>
          <h2 id="result-title">Results</h2>
          <p id="result-score" class="lead"></p>
          <p id="best-score" class="muted"></p>
        </header>
        <footer class="actions">
          <button id="playAgainBtn" class="contrast">Play again</button>
        </footer>
      </article>
    </main>
    <!-- Settings Modal -->
    <div id="settingsModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-overlay" data-close="true"></div>
      <div class="modal-content" role="document">
        <header class="modal-header">
          <h2 id="settingsTitle">Settings</h2>
          <button type="button" class="icon-btn" id="settingsClose" aria-label="Close settings" title="Close">
            <span aria-hidden="true">âœ•</span>
          </button>
        </header>
        <section class="modal-body">
          <fieldset>
            <legend class="muted">Game mode</legend>
            <label class="row">
              <input type="radio" name="gameMode" id="modeQuiz" value="quiz" />
              <span>Quiz</span>
            </label>
            <label class="row">
              <input type="radio" name="gameMode" id="modePairs" value="pairs" />
              <span>Pairs</span>
            </label>
          </fieldset>
        </section>
        <footer class="modal-footer">
          <button type="button" id="settingsApply" class="contrast">Apply</button>
        </footer>
      </div>
    </div>
    <script src="./script.js" defer></script>
  </body>
  </html>
